<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="generator" content=
"HTML Tidy for Windows (vers 22 March 2008), see www.w3.org" />
<title>Tcl Windows API extension</title>
<link rel="shortcut icon" href="favicon.ico" />
<link rel="stylesheet" type="text/css" href=
"http://yui.yahooapis.com/2.5.1/build/reset-fonts-grids/reset-fonts-grids.css" />
<link rel="stylesheet" type="text/css" href="styles.css" />
</head>
<body>
<div id="doc" class="yui-t4">
<div id='hd'>
<div class='searchbox'><!-- SiteSearch Google -->
<form method="get" action="http://www.google.com/custom" target=
"_top">
<table border="0" bgcolor="#FFFFFF" summary="Search">
<tr>
<td nowrap="nowrap" valign="top" align="left" height="32"><br />
<input type="hidden" name="domains" value="magicsplat.com" />
<label for="sbi" style="display: none">Enter your search
terms</label> <input type="text" name="q" size="31" maxlength="255"
value="" id="sbi" /></td>
</tr>
<tr>
<td nowrap="nowrap">
<table summary="Search buttons">
<tr>
<td><input type="radio" name="sitesearch" value="" checked=
"checked" id="ss0" /> <label for="ss0" title=
"Search the Web"><font size="-1" color=
"#000000">Web</font></label></td>
<td><input type="radio" name="sitesearch" value="magicsplat.com"
id="ss1" /> <label for="ss1" title=
"Search magicsplat.com"><font size="-1" color=
"#000000">magicsplat.com</font></label></td>
</tr>
</table>
<label for="sbb" style="display: none">Submit search form</label>
<input type="submit" name="sa" value="Google Search" id="sbb" />
<input type="hidden" name="client" value="pub-4771202757544410" />
<input type="hidden" name="forid" value="1" /> <input type="hidden"
name="ie" value="ISO-8859-1" /> <input type="hidden" name="oe"
value="ISO-8859-1" /> <input type="hidden" name="safe" value=
"active" /> <input type="hidden" name="cof" value=
"GALT:#008000;GL:1;DIV:#808080;VLC:663399;AH:center;BGC:FFFFFF;LBGC:ffffff;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:36;LW:82;L:http://www.magicsplat.com/magicsplat.png;S:http://www.magicsplat.com;LP:1;FORID:1" />
 <input type="hidden" name="hl" value="en" /></td>
</tr>
</table>
</form>
<!-- SiteSearch Google --></div>
<div class='headingbar'><a href=
'http://www.magicsplat.com'><img style=
'float:right; padding-right: 5px;' src='magicsplat.png' alt=
'site logo' /></a>
<p><a href='index.html'>Tcl Windows API extension</a></p>
</div>
</div>
<div id="bd">
<div id="yui-main">
<div class="yui-b">
<div class="yui-gf">
<div class="yui-u content">
<h2>Task Scheduler</h2>
<p>Commands related to the Windows task scheduler</p>
<h3><a name="synopsis" id="synopsis">SYNOPSIS</a></h3>
package require <b>twapi</b><br />
<table class="commandsummary" summary="Table">
<tr valign="top">
<td><a href="#itask_configure"><b class='cmd'>itask_configure</b>
<i class='arg'>ITASK_HANDLE</i> ?<i class=
'arg'>options</i>?</a></td>
</tr>
<tr valign="top">
<td><a href="#itask_delete_itasktrigger"><b class=
'cmd'>itask_delete_itasktrigger</b> <i class='arg'>ITASK_HANDLE</i>
<i class='arg'>INDEX</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itask_edit_dialog"><b class=
'cmd'>itask_edit_dialog</b> <i class=
'arg'>ITASK_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itask_end"><b class='cmd'>itask_end</b> <i class=
'arg'>ITASK_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itask_get_info"><b class='cmd'>itask_get_info</b>
<i class='arg'>ITASK_HANDLE</i> ?<i class=
'arg'>options</i>?</a></td>
</tr>
<tr valign="top">
<td><a href="#itask_get_itasktrigger"><b class=
'cmd'>itask_get_itasktrigger</b> <i class='arg'>ITASK_HANDLE</i>
<i class='arg'>INDEX</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itask_get_itasktrigger_count"><b class=
'cmd'>itask_get_itasktrigger_count</b> <i class=
'arg'>ITASK_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itask_get_itasktrigger_string"><b class=
'cmd'>itask_get_itasktrigger_string</b> <i class=
'arg'>ITASK_HANDLE</i> <i class='arg'>INDEX</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itask_get_runtimes_within_interval"><b class=
'cmd'>itask_get_runtimes_within_interval</b> ?<i class=
'arg'>options</i>?</a></td>
</tr>
<tr valign="top">
<td><a href="#itask_new_itasktrigger"><b class=
'cmd'>itask_new_itasktrigger</b> <i class=
'arg'>ITASK_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itask_release"><b class='cmd'>itask_release</b>
<i class='arg'>ITASK_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itask_run"><b class='cmd'>itask_run</b> <i class=
'arg'>ITASK_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itask_save"><b class='cmd'>itask_save</b> <i class=
'arg'>ITASK_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itaskscheduler_delete_task"><b class=
'cmd'>itaskscheduler_delete_task</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>TASKNAME</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itaskscheduler_get_itask"><b class=
'cmd'>itaskscheduler_get_itask</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>TASKNAME</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itaskscheduler_get_target_system"><b class=
'cmd'>itaskscheduler_get_target_system</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itaskscheduler_get_tasks"><b class=
'cmd'>itaskscheduler_get_tasks</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itaskscheduler_new"><b class=
'cmd'>itaskscheduler_new</b> ?<b class='cmd'>-system</b> <i class=
'arg'>SYSTEMNAME</i>?</a></td>
</tr>
<tr valign="top">
<td><a href="#itaskscheduler_new_itask"><b class=
'cmd'>itaskscheduler_new_itask</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>TASKNAME</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itaskscheduler_release"><b class=
'cmd'>itaskscheduler_release</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itaskscheduler_set_target_system"><b class=
'cmd'>itaskscheduler_set_target_system</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>SYSTEMNAME</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itaskscheduler_task_exists"><b class=
'cmd'>itaskscheduler_task_exists</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>TASKNAME</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itasktrigger_configure"><b class=
'cmd'>itasktrigger_configure</b> <i class=
'arg'>ITASKTRIGGER_HANDLE</i> ?<i class='arg'>options</i>?</a></td>
</tr>
<tr valign="top">
<td><a href="#itasktrigger_get_info"><b class=
'cmd'>itasktrigger_get_info</b> <i class=
'arg'>ITASKTRIGGER_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#itasktrigger_release"><b class=
'cmd'>itasktrigger_release</b> <i class=
'arg'>ITASKTRIGGER_HANDLE</i></a></td>
</tr>
<tr valign="top">
<td><a href="#mstask_create"><b class='cmd'>mstask_create</b>
<i class='arg'>TASKNAME</i> ?<i class='arg'>options</i>?</a></td>
</tr>
<tr valign="top">
<td><a href="#mstask_delete"><b class='cmd'>mstask_delete</b>
<i class='arg'>TASKNAME</i> ?<i class='arg'>options</i>?</a></td>
</tr>
</table>
<h3><a name="description" id="description">DESCRIPTION</a></h3>
<p>This module provides commands for scheduling and running jobs
through the Windows task scheduler.</p>
<h3><a name="overview" id="overview">Overview</a></h3>
<p>The Windows task scheduler allows programs to be automatically
started at certain times or when certain conditions are met. Tasks
may be scheduled on either local or remote computers.</p>
<p>The simplest way to create and delete tasks is through the
<a href="#mstask_create"><b class='cmd'>mstask_create</b></a> and
<a href="#mstask_delete"><b class='cmd'>mstask_delete</b></a>
commands. These take care of acquiring and releasing the low lever
interface handles and deal with the common case where a single task
trigger is associated with a task.</p>
<p>More flexible and complete task scheduler functionality is
available through commands that expose the interface handles to the
different types of task scheduler objects. Working with the task
scheduler involves three types of objects:</p>
<ul class="noclass">
<li>The task scheduler service which manages tasks</li>
<li>A task which is a unit of work scheduled by the task scheduler
and is identified by a name unique to a system.</li>
<li>A task trigger which defines the conditions under which a task
will be run. A task may have multiple associated task
triggers.</li>
</ul>
<p>An interface to the local or a remote task scheduler is obtained
through the <a href="#itaskscheduler_new"><b class=
'cmd'>itaskscheduler_new</b></a> command. The returned interface
handle can be used to manage tasks on that computer. The commands
<a href="#itaskscheduler_get_target_system"><b class=
'cmd'>itaskscheduler_get_target_system</b></a> and <a href=
"#itaskscheduler_set_target_system"><b class=
'cmd'>itaskscheduler_set_target_system</b></a> allow retrieving and
changing the system associated with the task scheduler handle at
any time.</p>
<p>Once a task scheduler interface handle is obtained, it can be
used to access task definitions for that scheduler. The commands
<a href="#itaskscheduler_new_itask"><b class=
'cmd'>itaskscheduler_new_itask</b></a> and <a href=
"#itaskscheduler_get_itask"><b class=
'cmd'>itaskscheduler_get_itask</b></a> will return interfaces to
new and existing tasks which can be manipulated as described below.
Tasks can also be deleted through the <a href=
"#itaskscheduler_delete_task"><b class=
'cmd'>itaskscheduler_delete_task</b></a> command and enumerated
using <a href="#itaskscheduler_get_tasks"><b class=
'cmd'>itaskscheduler_get_tasks</b></a>. Existence of a task
definition can be verified using the <a href=
"#itaskscheduler_task_exists"><b class=
'cmd'>itaskscheduler_task_exists</b></a> command. (Note: as a
general rule, commands related to tasks that require a task
interface handle use <span class="em">itask</span> in the command
name while commands that require a task name use <span class=
"em">task</span>.)</p>
<p>Once an interface handle to a task is obtained, its settings can
be accessed and modified through the <a href=
"#itask_get_info"><b class='cmd'>itask_get_info</b></a> and
<a href="#itask_configure"><b class='cmd'>itask_configure</b></a>
commands. Any changes made must be saved by then calling the
<a href="#itask_save"><b class='cmd'>itask_save</b></a> command.
Alternately, <a href="#itask_edit_dialog"><b class=
'cmd'>itask_edit_dialog</b></a> may be used to display a dialog
that allows the user to configure a task.</p>
<p>In addition to scheduling through the task scheduler, task
execution can also be directly controlled. <a href=
"#itask_run"><b class='cmd'>itask_run</b></a> will immediately run
a task while <a href="#itask_end"><b class='cmd'>itask_end</b></a>
will terminate a task that is currently executing. Future times
when a task will be run can be obtained using the <a href=
"#itask_get_runtimes_within_interval"><b class=
'cmd'>itask_get_runtimes_within_interval</b></a> call.</p>
<p>Each task is associated with zero or more task triggers that
determine when and under what conditions the task is executed. The
commands <a href="#itask_new_itasktrigger"><b class=
'cmd'>itask_new_itasktrigger</b></a> and <a href=
"#itask_get_itasktrigger"><b class=
'cmd'>itask_get_itasktrigger</b></a> return interface handles to
new or existing task triggers. When not required triggers can be
deleted through <a href="#itask_delete_itasktrigger"><b class=
'cmd'>itask_delete_itasktrigger</b></a>. The number of triggers
associated with a task can be obtained through the <a href=
"#itask_get_itasktrigger_count"><b class=
'cmd'>itask_get_itasktrigger_count</b></a> command. <a href=
"#itask_get_itasktrigger_string"><b class=
'cmd'>itask_get_itasktrigger_string</b></a> returns a string
describing the trigger.</p>
<p>Once a handle to a trigger is obtained, its settings can be
retrieved and modified through the <a href=
"#itasktrigger_get_info"><b class=
'cmd'>itasktrigger_get_info</b></a> and <a href=
"#itasktrigger_configure"><b class=
'cmd'>itasktrigger_configure</b></a> commands respectively.</p>
<h3><a name="commands" id="commands">Commands</a></h3>
<dl class="noclass">
<dt><a name="itask_configure" id="itask_configure"><b class=
'cmd'>itask_configure</b> <i class='arg'>ITASK_HANDLE</i>
?<i class='arg'>options</i>?</a></dt>
<dd>Modifies the settings for the task associated with the handle
<i class='arg'>ITASK_HANDLE</i>. Note that the command <a href=
"#itask_save"><b class='cmd'>itask_save</b></a> must be called to
save the changes.<br />
<br />
The following options may be specified to change the settings for
the task:
<table class="opt" summary="Table">
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-account</b></span> <i class='arg'>USERNAME</i></td>
<td class="opt">Sets <i class='arg'>USERNAME</i> as the account
under which the task will be run. If <i class='arg'>USERNAME</i> is
specified as the empty string, the task will be run under the
system account. If any user other than the system account is
specified, the <b class='cmd'>-password</b> option must also be
specified.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-application</b></span> <i class='arg'>PATH</i></td>
<td class="opt">Sets the application to be executed to <i class=
'arg'>PATH</i>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-comment</b></span> <i class='arg'>COMMENT</i></td>
<td class="opt">Sets the comment for the task.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-creator</b></span> <i class='arg'>NAME</i></td>
<td class="opt">Sets the task's creator name.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-data</b></span> <i class='arg'>BINDATA</i></td>
<td class="opt">Stores <i class='arg'>BINDATA</i> as the
application-defined data for the task. <i class='arg'>BINDATA</i>
is treated as binary data.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-deletewhendone</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task will be automatically deleted from the task scheduler when
it has no more scheduled run times. Default is <span class=
"strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-disabled</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task is disabled and will not be run at its scheduled times.
Default is <span class="strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-dontstartonbatteries</b></span> <i class=
'arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task is not started at the scheduled time if the system is
running on batteries. Default is <span class=
"strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-hidden</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task is hidden. Default is <span class=
"strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-idlewait</b></span> <i class='arg'>MINUTES</i></td>
<td class="opt">Sets the number of minutes that the system must be
idle before the task runs.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-idlewaitdeadline</b></span> <i class='arg'>MINUTES</i></td>
<td class="opt">Sets the maximum number of minutes that the task
scheduler will wait for the system to become idle.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-killifonbatteries</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task is not terminated if if the system is switches to
batteries while the task is running. Default is <span class=
"strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-killonidleend</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task is terminated, if running, when the computer switches to a
non-idle state (i.e. receives user input). Default is <span class=
"strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-maxruntime</b></span> <i class='arg'>MILLISECONDS</i></td>
<td class="opt">Sets the maximum time (in milliseconds) the
application can run before it is terminated. If <i class=
'arg'>MILLISECONDS</i> is specified as -1, there is no limit on the
run time.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-params</b></span> <i class='arg'>PARAMSTRING</i></td>
<td class="opt">Sets <i class='arg'>PARAMSTRING</i> as the
parameters to be passed to the application when the task is
run.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-password</b></span> <i class='arg'>PASSWORD</i></td>
<td class="opt">Specifies <i class='arg'>PASSWORD</i> as the
password associated with the user account specified with the
<b class='cmd'>-account</b> option.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-priority</b></span> <i class='arg'>PRIORITY</i></td>
<td class="opt">Sets the priority for the process executing the
task. <i class='arg'>PRIORITY</i> must be one of <span class=
"strong">normal</span>, <span class="strong">abovenormal</span>,
<span class="strong">belownormal</span>, <span class=
"strong">high</span>, <span class="strong">realtime</span>, or
<span class="strong">idle</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-resumesystem</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the system will be awakened from a suspended state, if necessary,
at the task's scheduled time. Default is <span class=
"strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-restartonidleresume</b></span> <i class=
'arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task is restarted when the system goes into an idle state and
the task had been previously terminated when the system went into a
non-idle state. Default is <span class="strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-runonlyifloggedon</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task is only run if the user specified through the <b class=
'cmd'>-account</b> option is logged on. Default is <span class=
"strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-startonlyifidle</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task is only run if the system is idle at the task's scheduled
run time. Default is <span class="strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-workingdir</b></span> <i class='arg'>PATH</i></td>
<td class="opt">Sets <i class='arg'>PATH</i> as the working
directory when the task is executed.</td>
</tr>
</table>
</dd>
<dt><a name="itask_delete_itasktrigger" id=
"itask_delete_itasktrigger"><b class=
'cmd'>itask_delete_itasktrigger</b> <i class='arg'>ITASK_HANDLE</i>
<i class='arg'>INDEX</i></a></dt>
<dd>Deletes the task trigger at position <i class='arg'>INDEX</i>
in the list of triggers for the task associated with handle
<i class='arg'>ITASK_HANDLE</i>.</dd>
<dt><a name="itask_edit_dialog" id="itask_edit_dialog"><b class=
'cmd'>itask_edit_dialog</b> <i class=
'arg'>ITASK_HANDLE</i></a></dt>
<dd>Displays a dialog that allows the user to edit the task
properties. Note that the dialog is modal and will lock out other
windows until it is closed.</dd>
<dt><a name="itask_end" id="itask_end"><b class='cmd'>itask_end</b>
<i class='arg'>ITASK_HANDLE</i></a></dt>
<dd>Terminates (forcibly if necessary) the task associated with
handle <i class='arg'>ITASK_HANDLE</i> it it is running.</dd>
<dt><a name="itask_get_info" id="itask_get_info"><b class=
'cmd'>itask_get_info</b> <i class='arg'>ITASK_HANDLE</i> ?<i class=
'arg'>options</i>?</a></dt>
<dd>Returns the settings for the task associated with handle
<i class='arg'>ITASK_HANDLE</i>. Any of the options described in
<a href="#itask_configure"><b class='cmd'>itask_configure</b></a>,
except <b class='cmd'>-password</b>, may be specified to retrieve
the corresponding setting. In addition, the command supports the
following additional options:
<table class="opt" summary="Table">
<tr class="opt">
<td class="opt" width="20%"><span class="strong"><b class=
'cmd'>-all</b></span></td>
<td class="opt">Returns all settings.</td>
</tr>
<tr class="opt">
<td class="opt" width="20%"><span class="strong"><b class=
'cmd'>-lastruntime</b></span></td>
<td class="opt">Returns the last time that the task was run in the
format <i class='arg'>Year-Month-Day Hour-Minutes-Seconds</i>. An
empty string is returned if the task has not been run yet.</td>
</tr>
<tr class="opt">
<td class="opt" width="20%"><span class="strong"><b class=
'cmd'>-nextruntime</b></span></td>
<td class="opt">Returns the next time that the task is scheduled to
run in the format <i class='arg'>Year-Month-Day
Hour-Minutes-Seconds</i>. The return value may also be one of
<span class="strong">disabled</span> if the task is disabled,
<span class="strong">notriggers</span> if no triggers are defined
for it, or <span class="strong">oneventonly</span> if the task is
configured to run on events as opposed to time.</td>
</tr>
<tr class="opt">
<td class="opt" width="20%"><span class="strong"><b class=
'cmd'>-status</b></span></td>
<td class="opt">Returns the status of the task which is one of
<span class="strong">ready</span>, <span class=
"strong">running</span>, <span class="strong">disabled</span>,
<span class="strong">partiallydefined</span>, or <span class=
"strong">unknown</span>.</td>
</tr>
</table>
</dd>
<dt><a name="itask_get_itasktrigger" id=
"itask_get_itasktrigger"><b class='cmd'>itask_get_itasktrigger</b>
<i class='arg'>ITASK_HANDLE</i> <i class='arg'>INDEX</i></a></dt>
<dd>Returns an interface handle for an existing task trigger for
the task associated with the handle <i class=
'arg'>ITASK_HANDLE</i>. <i class='arg'>INDEX</i> is the index of
the trigger in the list of triggers defined for the task. When no
longer required, the returned handle must be released by calling
<a href="#itasktrigger_release"><b class=
'cmd'>itasktrigger_release</b></a>.</dd>
<dt><a name="itask_get_itasktrigger_count" id=
"itask_get_itasktrigger_count"><b class=
'cmd'>itask_get_itasktrigger_count</b> <i class=
'arg'>ITASK_HANDLE</i></a></dt>
<dd>Returns the number of task triggers defined for the task
associated with handle <i class='arg'>ITASK_HANDLE</i>.</dd>
<dt><a name="itask_get_itasktrigger_string" id=
"itask_get_itasktrigger_string"><b class=
'cmd'>itask_get_itasktrigger_string</b> <i class=
'arg'>ITASK_HANDLE</i> <i class='arg'>INDEX</i></a></dt>
<dd>Returns a string description for an existing task trigger for
the task associated with the handle <i class=
'arg'>ITASK_HANDLE</i>. <i class='arg'>INDEX</i> is the index of
the trigger in the list of triggers defined for the task.</dd>
<dt><a name="itask_get_runtimes_within_interval" id=
"itask_get_runtimes_within_interval"><b class=
'cmd'>itask_get_runtimes_within_interval</b> ?<i class=
'arg'>options</i>?</a></dt>
<dd>Returns a list of times that the task is scheduled to run
within a specified interval. Each item in the list is in the format
<i class='arg'>Year-Month-Day Hour-Minutes-Seconds</i>. The
following options may be specified:
<table class="opt" summary="Table">
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-count</b></span> <i class='arg'>COUNT</i></td>
<td class="opt">The maximum number of time elements to return.
<i class='arg'>COUNT</i> must be less than 1440. The actual number
returned may of course be less than <i class='arg'>COUNT</i>
depending on how many times the task is scheduled to run in the
specified interval.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-end</b></span> <i class='arg'>DATETIMESPEC</i></td>
<td class="opt">The ending time of the interval specified as
<i class='arg'>Year-Month-Day Hour-Minutes-Seconds</i>. By default,
this is January 1, 2038.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-start</b></span> <i class='arg'>DATETIMESPEC</i></td>
<td class="opt">The starting time of the interval specified as
<i class='arg'>Year-Month-Day Hour-Minutes-Seconds</i>. By default,
this is the current time.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-statusvar</b></span> <i class='arg'>VARNAME</i></td>
<td class="opt">If specified, <i class='arg'>VARNAME</i> in the
caller's context is set to the status of the call. This is
<span class="strong">success</span> to indicate successful
retrieval of the scheduled times. Otherwise, it may also be be one
of <span class="strong">disabled</span> if the task is disabled,
<span class="strong">notriggers</span> if no triggers are defined
for it, or <span class="strong">oneventonly</span> if the task is
configured to run on events as opposed to time. In all these three
cases, the return value of the command is an empty list.</td>
</tr>
</table>
</dd>
<dt><a name="itask_new_itasktrigger" id=
"itask_new_itasktrigger"><b class='cmd'>itask_new_itasktrigger</b>
<i class='arg'>ITASK_HANDLE</i></a></dt>
<dd>Creates a new task trigger for the task associated with the
handle <i class='arg'>ITASK_HANDLE</i>. The command returns a list
of two elements. The first is the index of the newly created
trigger in the list of triggers defined for the task. The second
element is an interface handle to the newly defined task trigger.
When no longer required, this must be released by calling <a href=
"#itasktrigger_release"><b class=
'cmd'>itasktrigger_release</b></a>.</dd>
<dt><a name="itask_release" id="itask_release"><b class=
'cmd'>itask_release</b> <i class='arg'>ITASK_HANDLE</i></a></dt>
<dd>Releases resources associated with a task handle.</dd>
<dt><a name="itask_run" id="itask_run"><b class='cmd'>itask_run</b>
<i class='arg'>ITASK_HANDLE</i></a></dt>
<dd>Runs the task associated with handle <i class=
'arg'>ITASK_HANDLE</i>.</dd>
<dt><a name="itask_save" id="itask_save"><b class=
'cmd'>itask_save</b> <i class='arg'>ITASK_HANDLE</i></a></dt>
<dd>Saves any changes that have been made to the task associated
with handle <i class='arg'>ITASK_HANDLE</i>.</dd>
<dt><a name="itaskscheduler_delete_task" id=
"itaskscheduler_delete_task"><b class=
'cmd'>itaskscheduler_delete_task</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>TASKNAME</i></a></dt>
<dd>Deletes an existing task with name <i class='arg'>TASKNAME</i>
from the task scheduler associated with the handle <i class=
'arg'>ITASKSCHEDULER_HANDLE</i>.</dd>
<dt><a name="itaskscheduler_get_itask" id=
"itaskscheduler_get_itask"><b class=
'cmd'>itaskscheduler_get_itask</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>TASKNAME</i></a></dt>
<dd>Returns an interface handle to an existing task with name
<i class='arg'>TASKNAME</i>. <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> is an interface handle to a task
scheduler instance returned by <a href=
"#itaskscheduler_new"><b class='cmd'>itaskscheduler_new</b></a>.
The returned handle must be released by calling <a href=
"#itask_release"><b class='cmd'>itask_release</b></a> when it is no
longer required.</dd>
<dt><a name="itaskscheduler_get_target_system" id=
"itaskscheduler_get_target_system"><b class=
'cmd'>itaskscheduler_get_target_system</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i></a></dt>
<dd>Returns the name of the system that the task scheduler
associated with the handle <i class='arg'>ITASKSCHEDULER_HANDLE</i>
operates on.</dd>
<dt><a name="itaskscheduler_get_tasks" id=
"itaskscheduler_get_tasks"><b class=
'cmd'>itaskscheduler_get_tasks</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i></a></dt>
<dd>Returns a list of the names of the tasks contained in the task
scheduler associated with the handle <i class=
'arg'>ITASKSCHEDULER_HANDLE</i>.</dd>
<dt><a name="itaskscheduler_new" id="itaskscheduler_new"><b class=
'cmd'>itaskscheduler_new</b> ?<b class='cmd'>-system</b> <i class=
'arg'>SYSTEMNAME</i>?</a></dt>
<dd>Returns an interface handle to the task scheduler on the local
system, or if the <b class='cmd'>-system</b> option is specified,
on a remote system. The returned handle must be released by calling
<a href="#itaskscheduler_release"><b class=
'cmd'>itaskscheduler_release</b></a> when it is no longer
required.</dd>
<dt><a name="itaskscheduler_new_itask" id=
"itaskscheduler_new_itask"><b class=
'cmd'>itaskscheduler_new_itask</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>TASKNAME</i></a></dt>
<dd>Creates a new task with name <i class='arg'>TASKNAME</i> and
returns an interface handle to it. <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> is an interface handle to a task
scheduler instance returned by <a href=
"#itaskscheduler_new"><b class='cmd'>itaskscheduler_new</b></a>.
The returned handle must be released by calling <a href=
"#itask_release"><b class='cmd'>itask_release</b></a> when it is no
longer required.</dd>
<dt><a name="itaskscheduler_release" id=
"itaskscheduler_release"><b class='cmd'>itaskscheduler_release</b>
<i class='arg'>ITASKSCHEDULER_HANDLE</i></a></dt>
<dd>Releases resources associated with a task scheduler handle
returned by <a href="#itaskscheduler_new"><b class=
'cmd'>itaskscheduler_new</b></a>.</dd>
<dt><a name="itaskscheduler_set_target_system" id=
"itaskscheduler_set_target_system"><b class=
'cmd'>itaskscheduler_set_target_system</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>SYSTEMNAME</i></a></dt>
<dd>Sets the task scheduler associated with the handle <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> to be the system identified by
<i class='arg'>SYSTEMNAME</i>.</dd>
<dt><a name="itaskscheduler_task_exists" id=
"itaskscheduler_task_exists"><b class=
'cmd'>itaskscheduler_task_exists</b> <i class=
'arg'>ITASKSCHEDULER_HANDLE</i> <i class=
'arg'>TASKNAME</i></a></dt>
<dd>Returns <span class="strong">true</span> if a new task with
name <i class='arg'>TASKNAME</i> exists in the task scheduler
associated with handle <i class=
'arg'>ITASKSCHEDULER_HANDLE</i>.</dd>
<dt><a name="itasktrigger_configure" id=
"itasktrigger_configure"><b class='cmd'>itasktrigger_configure</b>
<i class='arg'>ITASKTRIGGER_HANDLE</i> ?<i class=
'arg'>options</i>?</a></dt>
<dd>Configures the task trigger associated with the handle
<i class='arg'>ITASKTRIGGER_HANDLE</i>.<br />
<br />
The following options may be specified to configure the task
trigger:
<table class="opt" summary="Table">
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-begindate</b></span> <i class='arg'>DATESPEC</i></td>
<td class="opt">Specifies the date on which the trigger is
activated. <i class='arg'>DATESPEC</i> must be in the format
<i class='arg'>YEAR-MONTH-DAY</i>. Defaults to the current
date.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-daysofmonth</b></span> <i class='arg'>MONTHDAYMASK</i></td>
<td class="opt">Specifies the days of the month that the task is
scheduled to run. <i class='arg'>MONTHDAYMASK</i> is a bitmask with
the low order bit corresponding to the first day of the month. This
option only has effect if the value of the <b class='cmd'>-type</b>
option is <span class="strong">monthlydate</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-disabled</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
disables the trigger so it has no effect. Default is <span class=
"strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-duration</b></span> <i class='arg'>MINUTES</i></td>
<td class="opt">Specifies the number of minutes after the task
starts that the trigger is active. The task will be continuously
restarted during this period with the interval between starts given
by the option <b class='cmd'>-interval</b>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-enddate</b></span> <i class='arg'>DATESPEC</i></td>
<td class="opt">Specifies the date on which the trigger becomes
inactive. <i class='arg'>DATESPEC</i> must be in the format
<i class='arg'>YEAR-MONTH-DAY</i>. If <i class='arg'>DATESPEC</i>
is the empty string, there is no end date and the trigger never
becomes inactive. This is also the default.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-interval</b></span> <i class='arg'>MINUTES</i></td>
<td class="opt">See description of <b class=
'cmd'>-duration</b>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-killatdurationend</b></span> <i class='arg'>BOOLEAN</i></td>
<td class="opt">If specified as <span class="strong">true</span>,
the task is terminated if it is still running at the end of the
trigger duration. Default is <span class=
"strong">false</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-months</b></span> <i class='arg'>MONTHMASK</i></td>
<td class="opt">Specifies the months in which the trigger is
active. <i class='arg'>MONTHMASK</i> is a bitmask with the low
order bit corresponding to January. The trigger is active in those
months for which the corresponding bit is set. By default, the
trigger is active for all months. This option is only used if the
<b class='cmd'>-type</b> option specifies the trigger type to be
either <span class="strong">monthlydate</span> or <span class=
"strong">monthlydow</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-period</b></span> <i class='arg'>PERIOD</i></td>
<td class="opt">If <b class='cmd'>-type</b> is <span class=
"strong">daily</span>, <i class='arg'>PERIOD</i> is the number of
days between invocations of the task. Similarly, if <b class=
'cmd'>-type</b> is <span class="strong">weekly</span>, <i class=
'arg'>PERIOD</i> is the number of weeks between invocations of the
task. This option is not used for other trigger types. If
unspecified, this option defaults to <span class=
"strong">1</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-starttime</b></span> <i class='arg'>TIMESPEC</i></td>
<td class="opt">Specifies the time at which the task is to be run.
<i class='arg'>TIMESPEC</i> is of the form <i class=
'arg'>HOUR:MINUTES</i>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-type</b></span> <i class='arg'>TRIGGERTYPE</i></td>
<td class="opt">Specifies the type of the trigger. If <i class=
'arg'>TRIGGERTYPE</i> is <span class="strong">once</span>, the task
will only be run once.<br />
<br />
A value of <span class="strong">daily</span> or <span class=
"strong">weekly</span> will cause the task to be scheduled daily or
weekly respectively. In both cases, the interval between runs being
governed by the <b class='cmd'>-period</b> option. Furthermore, in
the <span class="strong">weekly</span> case, the option <b class=
'cmd'>-weekdays</b> will control which days of the week the task is
run.<br />
<br />
If <i class='arg'>TRIGGERTYPE</i> is <span class=
"strong">monthlydate</span>, the task will be scheduled for the
days defined by the <b class='cmd'>-months</b> and <b class=
'cmd'>-daysofmonth</b> options.<br />
<br />
A value of <span class="strong">monthlydow</span> allows the task
to be scheduled during a specific week of a month. The <b class=
'cmd'>-weekofmonth</b> option specifies which week of the month,
the <b class='cmd'>-weekdays</b> option specifies which days in
that week, and <b class='cmd'>-months</b> option specifies which
months are included.<br />
<br />
In addition, there are three trigger types that are event based -
if <i class='arg'>TRIGGERTYPE</i> is <span class=
"strong">onidle</span>, the trigger is activated when the system
becomes idle, <span class="strong">atsystemstart</span> causes the
task to run every time the system starts and <span class=
"strong">atlogon</span> causes it to run everytime the user logs
on.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-weekdays</b></span> <i class='arg'>WEEKMASK</i></td>
<td class="opt">Specifies the days of a week that the trigger
should be activated. <i class='arg'>WEEKMASK</i> is a bitmask
corresponding to days of the week with the low order bit
corresponding to Sunday. This option is only used if <b class=
'cmd'>-type</b> is specified as <span class="strong">weekly</span>
or <span class="strong">monthlydow</span>.</td>
</tr>
<tr class="opt">
<td class="opt" width="30%"><span class="strong"><b class=
'cmd'>-weekofmonth</b></span> <i class='arg'>WEEKNUMBER</i></td>
<td class="opt">Specifies the week of the month that a task should
be active. <i class='arg'>WEEKNUMBER</i> must be an integer in the
range <span class="strong">1-5</span> where <span class=
"strong">1-4</span> correspond to the first four weeks while a
value of <span class="strong">5</span> corresponds to the last week
of the month.</td>
</tr>
</table>
</dd>
<dt><a name="itasktrigger_get_info" id=
"itasktrigger_get_info"><b class='cmd'>itasktrigger_get_info</b>
<i class='arg'>ITASKTRIGGER_HANDLE</i></a></dt>
<dd>Returns the settings for the task trigger associated with the
handle <i class='arg'>ITASKTRIGGER_HANDLE</i>. The settings are
returned as a flat list of <i class='arg'>option value</i> pairs.
See <a href="#itasktrigger_configure"><b class=
'cmd'>itasktrigger_configure</b></a> for information about the
returned fields. Note that the returned fields depend on the
trigger type as noted there.</dd>
<dt><a name="itasktrigger_release" id=
"itasktrigger_release"><b class='cmd'>itasktrigger_release</b>
<i class='arg'>ITASKTRIGGER_HANDLE</i></a></dt>
<dd>Releases resources associated with a task trigger handle.</dd>
<dt><a name="mstask_create" id="mstask_create"><b class=
'cmd'>mstask_create</b> <i class='arg'>TASKNAME</i> ?<i class=
'arg'>options</i>?</a></dt>
<dd>This is command is a wrapper around that the various task
scheduler interfaces that allows for easy creation of a task. It
handles the common case where a task has a single associated
trigger.<br />
<br />
The command creates a new task based on the specified options. It
accepts all the task related options as described for the <a href=
"#itask_configure"><b class='cmd'>itask_configure</b></a> command.
It associates a single trigger with the task and accepts all task
trigger configuration options described for task triggers in
<a href="#itasktrigger_configure"><b class=
'cmd'>itasktrigger_configure</b></a> except for <b class=
'cmd'>-disabled</b>.<br />
<br />
In addition, the command accepts the option <b class=
'cmd'>-system</b> which allows specification of which system the
task is to be created on. By default, the task is created on the
local system.</dd>
<dt><a name="mstask_delete" id="mstask_delete"><b class=
'cmd'>mstask_delete</b> <i class='arg'>TASKNAME</i> ?<i class=
'arg'>options</i>?</a></dt>
<dd>This is command is a wrapper around that the various task
scheduler interfaces that allows for easy deletion of a task.
<i class='arg'>TASKNAME</i> is the name that identifies the
task.<br />
<br />
The command accepts the option <b class='cmd'>-system</b> which
allows specification of which system the task is to be deleted. By
default, the task is deleted on the local system.</dd>
</dl>
<h3><a name="copyright" id="copyright">COPYRIGHT</a></h3>
<p>Copyright &copy; 2004-2007 Ashok P. Nadkarni</p>
</div>
<div class='yui-u first navigation'><a class='imgbutton' href=
'http://sourceforge.net/project/showfiles.php?group_id=90123'><img title='Download button'
alt='Download' src='download.png' onmouseover=
'javascript:this.src="download_active.png"' onmouseout=
'javascript:this.src="download.png"' /></a>
<hr style='width: 100px; margin-left: 0pt;' />
<h2>TWAPI 2.0.12 Documentation</h2>
<ul>
<li><a href='overview.html'>Overview</a></li>
<li><a href='installation.html'>Installation</a></li>
<li><a href='raw.html'>Win32 raw API</a></li>
<li><a href='ui.html'>Window management</a></li>
<li><a href='desktop.html'>Desktops and Window stations</a></li>
<li><a href='com.html'>COM</a></li>
<li><a href='shell.html'>Windows Shell</a></li>
<li><a href='input.html'>Keyboard and mouse input</a></li>
<li><a href='sound.html'>Sound</a></li>
<li><a href='clipboard.html'>Clipboard</a></li>
<li><a href='osinfo.html'>System</a></li>
<li><a href='process.html'>Processes, threads and DLLs</a></li>
<li><a href='handles.html'>Handles</a></li>
<li><a href='services.html'>Services</a></li>
<li><a href='network.html'>Network configuration</a></li>
<li><a href='disk.html'>Files, Disks and Volumes</a></li>
<li><a href='share.html'>Network shares and Lan Manager</a></li>
<li><a href='users.html'>Users and Groups</a></li>
<li><a href='security.html'>Security and access control</a></li>
<li><a href='crypto.html'>Cryptographic API</a></li>
<li><a href='eventlog.html'>Event log</a></li>
<li><a href='inifile.html'>Windows INI file</a></li>
<li><a href='console.html'>Console</a></li>
<li><a href='schedule.html'>Task Scheduler</a></li>
<li><a href='msi.html'>Microsoft Windows Installer</a></li>
<li><a href='nls.html'>Internationalization</a></li>
<li><a href='printer.html'>Printers</a></li>
<li><a href='device.html'>Device management</a></li>
<li><a href='power.html'>Power management</a></li>
<li><a href='errors.html'>Error generation and handling</a></li>
<li><a href='misc.html'>Miscellaneous</a></li>
<li><a href='examples.html'>Examples</a></li>
<li><a href='versionhistory.html'>Version History</a></li>
<li><a href='idx.html'>Index</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id='ft'>Tcl Windows API 2.0.12
<div class='copyright'>&copy; 2002-2008 Ashok P. Nadkarni</div>
<a href='http://www.magicsplat.com/privacy.html'>Privacy
policy</a></div>
</div>
</body>
</html>
