<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=ISO-8859-1">
  <title>testaudela</title>
</head>
<body>
<p class="date">Date de mise &agrave; jour : 2 mars 2007</p>
<h1>Test audela</h1>
<ul>
  <li><a href="#presentation">Pr&eacute;sentation</a><br>
  </li>
  <li><a href="#campagne">Lancer une campagne de test</a></li>
  <li><a href="#creation_fichier_test">Cr&eacute;ation d'un nouveau
fichier de tests</a></li>
  <li><a href="#modification">Modification d'un fichier de tests</a><br>
  </li>
  <li><a href="#convention">Convention de nommage des fichiers de test</a></li>
  <li><a href="#utilisatires">Proc&eacute;dures utilitaires pour les
widgets</a></li>
</ul>
<p>&nbsp; <br>
</p>
<h1><a name="images"></a>T&eacute;l&eacute;charger les images de test</h1>
T&eacute;l&eacute;charger les images en cliquant sur le lien ci-dessous,<br>
puis les d&eacute;zipper dans un r&eacute;pertoire quelconque, <br>
puis indiquer le r&eacute;pertoire dans la fen&ecirc;tre de l'outil de
test.<br>
<br>
Images de test&nbsp; :&nbsp; <a
 href="http://www.audela.org/download/test-audela-image.zip">http://www.audela.org/download/test-audela-image.zip
</a><br>
<br>
<br>
Remarque: Les images de test ne sont pas founies avec AudeLA &agrave;
cause de leur volume important.<br>
<br>
<br>
<br>
<br>
<br>
<p></p>
<h1><a name="presentation"></a>Pr&eacute;sentation</h1>
Cet outil sert &agrave; lancer des tests automatiques de Audela.<br>
Pour lancer l'ex&eacute;cution de Test Audela, utiliser le menu<b>
Configuration-&gt;Test Audela</b><br>
<br>
<blockquote>
  <p><img style="width: 436px; height: 420px;" alt="testaudela"
 src="testaudela1.png"></p>
</blockquote>
<p><br>
</p>
<p>Le liste des fichiers de test est affich&eacute;e dans la zone
intitul&eacute;e "Fichiers de test"<br>
</p>
<div style="margin-left: 40px;"><span style="font-weight: bold;">Un
clic avec le bouton gauche de la souris</span> sur le nom d'un. fichier
de test permet d'afficher la liste des tests contenus dans le fichier
dans la zone intitul&eacute;e "Contenu du fichier
s&eacute;lectionn&eacute;"<br>
<br>
<span style="font-weight: bold;">Un double clic avec le bouton gauche
de la souris</span> sur le nom d'un fichier de test permet d'inclure ou
d'exclure un test de la campagne de test<br>
</div>
<ul style="margin-left: 40px;">
  <li>Les fichiers avec <span style="font-weight: bold;">une
ic&ocirc;ne
VERTE</span> sont inclus dans la campagne de tests. </li>
  <li>Les fichiers avec <span style="font-weight: bold;">une
ic&ocirc;ne
GRISE</span> ne sont pas inclus dans la campagne de tests.</li>
</ul>
<p style="margin-left: 40px;"><span style="font-weight: bold;">Un clic
avec le bouton droit de la souris</span> sur le nom d'un fichier de
test permet d'afficher le code source du test dans l'&eacute;diteur de
fichier d'Audela (Configurer auparavant l'&eacute;diteur avec le menu
Configuration &gt; Logiciels externes).<br>
</p>
<p style="margin-left: 40px;"><span style="font-weight: bold;">Le
bouton Actualiser</span> permet d'actualiser la liste des fichiers de
tests apr&egrave;s que l'on ait ajout&eacute; ou supprim&eacute; un
fichier de test, sans avoir &agrave; relancer Audela.&nbsp;</p>
<p style="margin-left: 40px;"><span style="font-weight: bold;">Le
bouton Tous </span>permet d'inclure tous les tests dans la campagne de
test.</p>
<p style="margin-left: 40px;"><span style="font-weight: bold;">Le
bouton Aucun </span>permet d'exclure tous les tests de la campagne de
test.<br>
</p>
<h1><a name="campagne"></a>Lancer une campagne de test</h1>
Ouvrir la fenetre "Test Audela" avec le menu&nbsp;<b>
Configuration-&gt;Test Audela<br>
<br>
</b>1) s&eacute;lectionner les fichiers de test de la campagne <br>
<blockquote>Seuls les tests avec une ic&ocirc;ne VERTE seront
ex&eacute;cut&eacute;s <br>
</blockquote>
<p>3) s&eacute;lectionner les contraintes</p>
<blockquote>
  <p>Les contraintes permettent de ne lancer que les tests pour
lesquels les p&eacute;riph&eacute;riques ou des logiciels requis sont
pr&eacute;sents. Les contraintes de chaque test sont
pr&eacute;cis&eacute;es dans le code source de chaque test..<br>
  </p>
  <p>Seuls les tests associ&eacute;s aux contraintes coch&eacute;es
sont ex&eacute;cut&eacute;s <br>
  <i>Exemples : </i></p>
  <blockquote>
    <p><i>Cocher la contrainte AUDACE pour ex&eacute;cuter les tests
qui utilisent l'IHM Audace</i></p>
    <p><i>Cocher la contrainte AUDINE pour ex&eacute;cuter les tests
qui utilisent la camera AUDINE.</i></p>
  </blockquote>
</blockquote>
<p>4) lancer la campagne de test</p>
<blockquote>
  <p>Cliquer sur le bouton <b>"Ex&eacute;cuter les tests"</b> pour
lancer la
campagne de tests. Le r&eacute;sultat est stock&eacute; dans le fichier
  <i>testresult.log </i>dans le r&eacute;pertoire audace(rep_log)/<i>testresult.log</i></p>
  <p><i>Remarque : certains tests qui ne sont pas compl&egrave;tement
automatis&eacute;s peuvent demander une action utilisateur. Par
exemple, les tests du menu pr&eacute;traitement n&eacute;cessitent de
cliquer sur le bouton "OK" pour continuer.</i></p>
  <p>A la fin de la campagne de test, les r&eacute;sultats
est affich&eacute;s dans une nouvelle fen&ecirc;tre :</p>
  <blockquote>
    <p><img style="width: 594px; height: 469px;" alt="testaudela log"
 src="testaudela2.png"></p>
  </blockquote>
  <p>Elle contient le r&eacute;sultat de chaque test avec le message
d'erreur retourn&eacute; par le script de test en cas d'&eacute;chec,
ainsi qu'un r&eacute;capitulatif avec : </p>
  <ul>
    <li>le nombre total de tests trouv&eacute;s dans les fichiers
s&eacute;lectionn&eacute;s pour la campagne (<span
 style="font-weight: bold;">Total</span>)<br>
    </li>
    <li>le nombre de tests r&eacute;ussis (<span
 style="font-weight: bold;">Passed</span>)</li>
    <li>le nombre de tests saut&eacute;s &agrave; cause des contraintes
non s&eacute;lectionn&eacute;es (<span style="font-weight: bold;">Skipped</span>)</li>
    <li>le nombre de tests ayant &eacute;chou&eacute; (<span
 style="font-weight: bold;">Failed</span>)</li>
  </ul>
  <p>&nbsp;<br>
  </p>
</blockquote>
<h1><a name="lancer_depuis_console"></a>Lancer une campagne depuis la
console</h1>
Pour lancer la campagne de test <span style="font-weight: bold;">depuis
la
console d'Audela</span> , il faut saisir la commande <span
 style="font-weight: bold;">::testaudela::runTests&nbsp;</span> <br>
<br>
Cette commande retourne une des valeurs suivantes : <br>
<ul>
  <li>&nbsp;&nbsp;&nbsp; 0&nbsp; si tous les tests sont pass&eacute;s
avec suc&eacute;s </li>
  <li>&nbsp;&nbsp;&nbsp; 1, 2, 3, ...&nbsp;&nbsp; le nombre de test
FAILED</li>
  <li>&nbsp; &nbsp; -1 si une erreur impr&eacute;vue a interrompu la
campagne de test&nbsp; </li>
</ul>
<br>
Pour lancer la campagne de test <span style="font-weight: bold;">depuis
un
fen&ecirc;tre terminal Windows ou linux</span>, il faut se placer
dans le r&eacute;pertoire de binaires d'Audela et saisir la commande <span
 style="font-weight: bold;">:<br>
audela "&lt;r&eacute;pertoire
audela&gt;/gui/audace/plugin/tool/testaudela/testaudela.tcl"
"::testaudela::runTests" <br>
<br>
</span>Le r&eacute;sultatest dans le fichier <span
 style="font-weight: bold;">testresult.log</span> plac&eacute; dans le
r&eacute;pertoire de travail d'Audela.<span style="font-weight: bold;"><br>
<br>
<br>
</span>
<blockquote></blockquote>
<h1><a name="creation_fichier_test"></a>Cr&eacute;ation d'un nouveau
fichier de test</h1>
<p>Un fichier de test est un script TCL enregistr&eacute; dans le
r&eacute;pertoire audela\gui\audace\plugin\tool\testaudela\tests .</p>
<p>Exemple de script de test :<br>
audela\gui\audace\plugin\tool\testaudela\tests\chart_carteducielv3.tcl</p>
Chaque test est cod&eacute; dans un bloc TCL commen&ccedil;ant par
"test" et qui la structure suivante :
<blockquote>
  <pre><b> <font style="color: rgb(51, 51, 255);" color="#ff0000">test</font></b><span
 style="color: rgb(51, 51, 255);"> </span><font color="#0000ff"><b>test_nom</b></font> {<b><font
 color="#0000ff">test_description</font></b>} {<font color="#0000ff"><b>test_contraintes</b></font>} {<br>   <font
 color="#0000ff">test_script</font> <br>   ...<br>   return $resultat<br> } <b><font
 color="#0000ff">test_resultat</font></b>

  </pre>
</blockquote>
<p>D&eacute;finitions : </p>
<ul>
  <li><b style="color: rgb(51, 51, 255);">test</b><span
 style="color: rgb(51, 51, 255);"> </span>: un test commence toujours
par la commande <b style="color: rgb(51, 51, 255);">"test"</b> </li>
  <li><b><font color="#0000ff">test_nom</font></b> : nom du test
(exemple: webcam_RGB_create)</li>
  <li><b><font color="#0000ff">test_description</font></b> : courte
phrase de description du test</li>
  <li><b><font color="#0000ff">test_contraintes</font></b> : liste des
contraintes n&eacute;cessaires pour ex&eacute;cuter le test (voir les
cases &agrave; cocher)</li>
  <li><b><font color="#0000ff">test_script</font></b>: script TCL
ex&eacute;cutant les commandes &agrave; tester. Le script doit retouner
une valeur avec la commande return.</li>
  <li><b><font color="#0000ff">test_resultat</font></b> :
r&eacute;sultat attendu. Si la valeur retoun&eacute;e par test_script
est &eacute;gale &agrave; cette valeur, le test est
consid&eacute;r&eacute; comme r&eacute;ussi (&eacute;tat PASSED dans le
rapport de test) sinon le test est consid&eacute;r&eacute; comme
&eacute;chou&eacute; (&eacute;tat FAILED dans le rapport de test).</li>
</ul>
<br>
<p>Exemple : </p>
<pre>test webcam_RGB_create {creation de la camera RGB } { WEBCAM_RGB } {<br>      set camNo [cam::create webcam USB -channel 0) \<br>          -lpport "" -name WEBCAM -ccd "ICX098BQ-A" ]<br>      set bufNo [cam$camNo buf]<br>      return $camNo<br>   } "1"</pre>
<p>Ce test "webcam_RGB_create" ne sera ex&eacute;cut&eacute; dans un
campagne de test que si la contrainte WEBCAM_RGB est coch&eacute;e. </p>
<p>Le r&eacute;sultat de ce test est "Passed" s'il retourne "1",
"Failed" s'il
retourne autre chose que "1", "Skipped" si la contrainte WEBCAM_RGB
n'est
pas coch&eacute;e.</p>
<p><b><i>Remarques : </i></b></p>
<p><i>Pour rafraichir l'affichage de la liste des fichiers de test </i><i>apr&egrave;s
modification
de
ces param&egrave;tres, cliquer sur le bouton
"Actualiser".</i></p>
<p>Un fichier peut contenir plusieurs blocs . Les blocs doivent avoir
des noms diff&eacute;rents. Pour plus de d&eacute;tail sur la commande
"test"
du TCL voir : <a href="http://www.tcl.tk/man/tcl8.4/TclCmd/tcltest.htm">http://www.tcl.tk/man/tcl8.4/TclCmd/tcltest.htm</a></p>
<p></p>
<p style="font-style: italic;">Les images de r&eacute;f&eacute;rence
utilis&eacute;es par les tests sont dans le
r&eacute;pertoire audela\gui\audace\plugin\tool\testaudela\images
. <br>
Il e<br>
</p>
<h1><a name="modification"></a>Modification d'un fichier de test</h1>
<span style="font-weight: bold;">Cliquer avec le bouton droit de la
souris</span> sur le nom d'un fichier de
test pour afficher le code source du test dans l'&eacute;diteur de
fichier d'Audela.<br>
<br>
<span style="font-weight: bold;">Modifier le code source du test </span>et
enregistrer
les modifications avec la commande Enregistrer de
l'&eacute;diteur de texte.<br>
<br>
<span style="font-weight: bold;">Relancer la campagne de test </span>pour
v&eacute;rifier
le fonctionnement du Test . Il n 'est pas
n&eacute;cessaire de relancer Audela pour prendre en
compte la modification du test car le fichier est
r&eacute;-interpr&eacute;t&eacute; &agrave; la vol&eacute;e quand lance
la campagne de test. <br>
<br>
<br>
<h1><a name="convention"></a>Convention de nommage des fichiers de tests</h1>
<ul>
  <li>Test des fen&ecirc;tres de "Audace"
    <ul>
      <li>audace_fichier.tcl : test du menu "Fichier" de Audace</li>
      <li>audace_affichage.tcl : test du menu "Affichage" de Audace</li>
      <li>audace_pr&eacute;traitement.tcl : test du menu "Pretraitment"
de
Audace</li>
      <li>....</li>
    </ul>
  </li>
  <li>Test individuel des librairies *.dll du c&#339;ur d'Audela
    <ul>
      <li>libaudela_xxxx.tcl : tests de libaudela</li>
      <li>libtt_xxxx.tcl : tests de libtt</li>
      <li>...</li>
    </ul>
  </li>
  <li>Test des outils
    <ul>
      <li>tool_acqfc.tcl</li>
      <li>tool_xxxx.tcl</li>
      <li>...</li>
    </ul>
  </li>
  <li>Test des cameras
    <ul>
      <li>cam_audine.tcl : tests de la camera audine</li>
      <li>cam_xxx.tcl : tests de la camera xxx</li>
      <li>...</li>
    </ul>
  </li>
  <li>Test des t&eacute;lescopes
    <ul>
      <li>tel_lx200.tcl : tests du t&eacute;lescope Lx200</li>
      <li>tel_xxx.tcl : tests du t&eacute;lescope xxx</li>
      <li>...</li>
    </ul>
  </li>
  <li>Test des &eacute;quipements
    <ul>
      <li>eqt_focuserjmi.tcl : tests du focuser JMI</li>
      <li>eqt_xxx.tcl : tests de l'&eacute;quipement xxx</li>
      <li>...</li>
    </ul>
  </li>
</ul>
<h1><a name="utilisatires"></a>Proc&eacute;dure utilitaires pour les
widgets</h1>
<p>Le fichier testaudela.tcl contient des proc&eacute;dures qui
facilitent les tests des fen&ecirc;tres en particulier pour simuler les
actions d'un utilisateur sur les widgets TK .<br>
</p>
<ul>
  <li><a href="#clicButton">::testaudela::clicButton<br>
    </a></li>
  <li><a href="#clicCheckButton">::testaudela::clicCheckButton</a></li>
  <li><a href="#clicCombobox">::testaudela::clicCombobox</a> </li>
  <li><a href="#clicMenu">::testaudela::clicMenu</a></li>
  <li><a href="#clicMenuButton">::testaudela::clicMenuButton</a></li>
  <li><a href="#clicRadioButton">::testaudela::clicRadioButton</a></li>
  <li><a href="#mouveMouse">::testaudela::mouveMouse</a></li>
  <li><a href="#putEntry">::testaudela::putEntry</a></li>
</ul>
<h3>Exemple :</h3>
<pre>global caption<br>set visuNo 1<br>test affichage_reticule_actif { affiche le reticule } {AUDACE} {<br>     #--- je clique sur le menu reticule<br>     ::testaudela::clicMenu $visuNo "$caption(audace,menu,affichage)" "[::Crosshair::getLabel]..."<br><br>     #--- je clique sur le checkbutton pour afficher le r&eacute;ticule<br>     ::testaudela::clicCheckButton [confVisu::getBase $visuNo].confCrossHair.frame1.frameState.currentstate<br><br>     #--- je ferme la fenetre la fenetre de parametrage du reticule<br>     ::testaudela::clicButton [confVisu::getBase $visuNo].confCrossHair.but_ok<br><br>     #--- je verifie que le reticule est affich&eacute;<br>     set result "[::confVisu::getCrosshair $visuNo]"<br>     append result " [[::confVisu::getCanvas 1] gettags lineh]"<br>     append result " [[::confVisu::getCanvas 1] gettags linev]"<br>     return $result<br>} "1 lineh linev"<br></pre>
<p>&nbsp;</p>
<h2>Liste des proc&eacute;dures utilitaires pour les widgets</h2>
<h3><a name="clicButton"></a>::testaudela::clicButton { buttonPath }</h3>
<blockquote>
  <p>simule un clic sur un bouton</p>
  <pre># parametres :<br># buttonPath : chemin complet du bouton<br><br><br># exemple: <br># ::testaudela::clicButton .audace.traiteImage.cmd.ok <br>   </pre>
</blockquote>
<h3><a name="clicCheckButton"></a>::testaudela::clicCheckButton {
buttonPath { state "" } }</h3>
<blockquote>
  <p>simule un clic sur un checkbutton ou force le check a une valeur<br>
  </p>
  <pre># parametres :<br># buttonPath : chemin complet du bouton<br># state :  etat de la case a coche "1" , "0" , ou basculement si ce parametre est absent<br>exemples: <br>::testaudela::clicCheckButton .audace.acqFC.mode.une.index.case <br>&gt;&gt;&gt; bascule le checkbutton <br><br>::testaudela::clicCheckButton .audace.acqFC.mode.une.index.case "1" <br>&gt;&gt;&gt; coche le checkbutton<br><br>::testaudela::clicCheckButton .audace.acqFC.mode.une.index.case "0"<br>&gt;&gt;&gt; decoche le checkbutton</pre>
</blockquote>
<h3><a name="clicCombobox"></a>::testaudela::clicCombobox {comboPath
index} </h3>
<blockquote>
  <p>simule un clic sur une combobox<br>
  </p>
  <pre># parametres :<br># comboPath : chemin complet du bouton de la combobox<br># index : index de l'item selectionne <br>#         Le premier item est a l'index 0<br>#         Valeurs pr&eacute;definies : first last next previous<br><br># exemples :<br># ::testaudela::clicCheckButton .audace.acqFC.mode 0 <br># ::testaudela::clicCheckButton .audace.acqFC.mode first <br># ::testaudela::clicCheckButton .audace.acqFC.mode last </pre>
</blockquote>
<h3><br>
<a name="clicMenu"></a>::testaudela::clicMenu { visuNo menuName
menuLabel }</h3>
<blockquote>
  <p>simule un clic sur un menu</p>
</blockquote>
<pre>   # parametres : <br>   # visuNo : numero de la visu<br>   # menuName : nom du menu principal<br>   # menuLabel : libelle de l'item du menu principal<br><br><br>   # exemple : <br>   # ::testaudela::clicMenu 1 "Affichage" "palette grise"<br>   </pre>
<h3><a name="clicMenuButton"></a>::testaudela::clicMenuButton {
buttonPath value}</h3>
<p>simule un clic sur un checkbutton</p>
<blockquote>
  <pre># parametres : <br># buttonPath : chemin complet du bouton de la combobox<br># value : valeur de l'item a selectionner <br><br><br># Exemple :<br># ::testaudela::clicMenuButton .audace.acqFC.mode.une.nom.extension ".jpg"</pre>
</blockquote>
<h3><br>
<a name="clicRadioButton"></a>::testaudela::clicRadioButton {
buttonPath } <br>
</h3>
<blockquote>
  <p>simule un clic sur un radiobutton</p>
  <p># parametres : <br>
# buttonPath : chemin complet du bouton </p>
</blockquote>
<h3><a name="mouveMouse"></a>::testaudela::mouveMouse { visuNo x_canvas
y_canvas } </h3>
<blockquote>
  <p> simule le deplacement du curseur de la souris vers un point x,y
du canvas (x,y sont en coordonnees canvas) </p>
  <pre># parametres : <br># visuNo : numero de la visu<br># x_canvas y_canvas : coordonnees du curseur de la souris<br>
# exemple :
# ::testaudela::mouveMouse 1 20 20</pre>
</blockquote>
<h3><a name="putEntry"></a>::testaudela::putEntry { entryPath value }</h3>
<blockquote>
  <p>simule la saisie dans un ENTRY </p>
  <pre># parametres : <br># entryPath : chemin complet du widget entry <br># value : valeur saisie<br><br><br># Exemple :<br># ::testaudela::putEntry .audace.acqFC.mode.une.nom.entr "m57" <br><br><br><br><br><br>   </pre>
</blockquote>
</body>
</html>
