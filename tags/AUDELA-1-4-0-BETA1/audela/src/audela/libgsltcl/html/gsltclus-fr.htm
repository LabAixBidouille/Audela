<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
    
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
    
  <meta name="GENERATOR"
 content="Mozilla/4.5 [fr] (Win98; I) [Netscape]">
    
  <meta name="Author" content="Alain Klotz">
  <title>Manuel d'utilisation de la librairie GSL pour Tcl</title>
     
  <script language="javascript" src="style.js">
  </script>
</head>
  <body bgcolor="#ffffff">
  
<center> 
<h1> LibGSLTcl</h1>
</center>
  
<center> 
<h2> Librairie d'extension Tcl pour le calcul scientifique</h2>
</center>
  
<center><b>Alain KLOTZ</b> <br>
<b>version 20030907</b></center>
  
<h1> 1. Introduction</h1>
 La librairie libgsltcl ajoute des fonctions de calculs scientifique &agrave; 
un interpr&eacute;teur Tcl. Cette librairie utilise la Gnu Scientific Library: 
<center> 
<p><a href="http://sources.redhat.com/gsl/">http://sources.redhat.com/gsl/</a></p>
</center>
  
<p>Le principe g&eacute;n&eacute;ral de libgsltcl est de transformer des listes
Tcl en vecteurs C qui sont soumis au calcul par les fonctions C de GSL. En
retour, libgsltcl, fourni le r&eacute;sultat sous forme d'une liste &agrave;
l'interpr&eacute;teur Tcl. Par exemple, pour calculer la transform&eacute;e
de Fourier du vecteur de valeurs 1; 2; 5; 7; 3; 1; -7; -4; -1; 0; on &eacute;crira
: </p>
<p><b><tt>set vec {1 2 5 7 3 1 -7 -4 -1 0}</tt></b> <br>
<b><tt>gsl_fft $vec</tt></b> </p>
<p>En retour, la fonction renvoie deux listes qui correspondent aux composantes 
r&eacute;elles et imaginaires du r&eacute;sultat de la transform&eacute;e 
de Fourier. </p>
<p>Les vecteurs sont de type "liste Tcl" (<b>ListVector</b>). Les matrices 
sont d&eacute;finies comme des "listes de listes Tcl" (<b>ListMatrix</b>). 
Par exemple, la matrice : </p>
<p><b><tt>&nbsp;&nbsp;&nbsp; [ 2&nbsp; 6&nbsp; 7 ]</tt></b> <br>
<b><tt>a = [ 1&nbsp; 2&nbsp; 3 ]</tt></b> <br>
<b><tt>&nbsp;&nbsp;&nbsp; [ 1&nbsp; 9&nbsp; 8 ]</tt></b> </p>
<p>sera cod&eacute;e de la fa&ccedil;on suivante en Tcl : </p>
<p><b><tt>set a { {2 6 7} {1 2 3} {1 9 8} }</tt></b> </p>
<p>On v&eacute;rifiera que l'&eacute;l&eacute;ment de la 1&egrave;re ligne 
et 3i&egrave;me colonne vaut 7: </p>
<p><b><tt>gsl_mindex $a 1 3</tt></b> </p>
<p>Dans toutes les fonctions, l'ordre des indices d'une matrice est toujours 
de la forme <i>ligne</i> puis <i>colonne</i>. <br>
&nbsp; </p>
<h1> 2. Manuel de l'utilisateur</h1>
  
<h2> 2.1. Manipulation des donn&eacute;es</h2>
  
<h3> <a name="gsl_mlength"></a>gsl_mlength ListMatrix</h3>
  
<blockquote>Retourne une liste de deux &eacute;l&eacute;ments dont les valeurs
sont les dimensions (nlignes ncolonnes) de la matrice ListMatrix.</blockquote>
  
<h3> <a name="gsl_mindex"></a>gsl_mindex ListMatrix IndexLig IndexCol</h3>
  
<blockquote>Retourne la valeur de l'&eacute;l&eacute;ment situ&eacute; &agrave;
la position (IndexLig IndexCol) de la matrice ListMatrix.</blockquote>
  
<h3> <a name="gsl_mreplace"></a>gsl_mreplace ListMatrix IndexLig IndexCol
Value</h3>
  
<blockquote>Remplace la valeur de l'&eacute;l&eacute;ment situ&eacute; &agrave;
la position (IndexLig IndexCol) de la matrice ListMatrix par Value</blockquote>
  
<h2> 2.2. Alg&egrave;bre matricielle</h2>
  
<h3> <a name="gsl_mtranspose"></a>gsl_mtranspose ListMatrix</h3>
  
<blockquote>Retourne la matrice r&eacute;sultat de la transpos&eacute;e de
la matrice ListMatrix</blockquote>
  
<h3> <a name="gsl_madd"></a>gsl_madd ListMatrixA ListMatrixB</h3>
  
<blockquote>Retourne la matrice r&eacute;sultat de la somme alg&eacute;brique 
de ListMatrixA et ListMatrixB</blockquote>
  
<h3> <a name="gsl_msub"></a>gsl_msub ListMatrixA ListMatrixB</h3>
  
<blockquote>Retourne la matrice r&eacute;sultat de la diff&eacute;rence alg&eacute;brique
de ListMatrixA et ListMatrixB</blockquote>
  
<h3> <a name="gsl_mmult"></a>gsl_mmult ListMatrixA ListMatrixB</h3>
  
<blockquote>Retourne la matrice r&eacute;sultat de la multiplication alg&eacute;brique 
de ListMatrixA par ListMatrixB</blockquote>
  
<h3> <a name="gsl_mdet"></a>gsl_mdet ListMatrix</h3>
  
<blockquote>Retourne la valeur du d&eacute;terminant de la matrice ListMatrix</blockquote>
  
<h3> <a name="gsl_minv"></a>gsl_minv ListMatrix</h3>
  
<blockquote>Retourne la matrice r&eacute;sultat de l'inverse de la matrice 
ListMatrix</blockquote>
  
<h3> <a name="gsl_meigsym"></a>gsl_meigsym ListMatrix</h3>
  
<blockquote>Retourne le vecteur des valeurs propres et la matrice des vecteurs 
propres de la matrice ListMatrix. Par exemple : 
  <p><b><tt>set a { {2 6 7} {1 6 3} {7 3 8} }</tt></b> <br>
  <b><tt>gsl_meigsym $a</tt></b> </p>
  <p>Retourne: <br>
{13.816095 4.882125 -2.698219} {{0.497108 0.285358 0.819423} {0.365628 -0.925327
0.100428} {0.786892 0.249681 -0.564323}}</p>
</blockquote>
  
<h2> 2.3. Calculs d'alg&egrave;bre lin&eacute;aire</h2>
  
<h3> <a name="gsl_msolvelin"></a>gsl_msolvelin ListMatrixA ListVectorB</h3>
  
<blockquote>Cette fonction permet de trouver les valeurs du vecteur inconnu 
X d&eacute;finit par B = A*X, o&ugrave; B est un vecteur et A est une matrice. 
Le vecteur X comporte p lignes (=p inconnues), et B comporte n lignes (=n 
observations). La matrice A est de dimensions n*p.</blockquote>
  
<h3> <a name="gsl_mfitmultilin"></a>gsl_mfitmultilin ListVectorY ListMatrixX 
ListVectorW</h3>
  
<ul>
Cette fonction permet la r&eacute;solution d'un syst&egrave;me multilin&eacute;aire 
de type y=X*c o&ugrave; : <br>
&nbsp; 
  <ul>
y est un vecteur de n observations&nbsp; (param&egrave;tre ListVectorY) 
    <p>X est une matrice n*p associ&eacute;e au mod&egrave;le physique &agrave; 
r&eacute;soudre (param&egrave;tre ListMatrixX) </p>
    <p>c est le vecteur des p inconnues &agrave; d&eacute;terminer</p>
  </ul>
  
  <p><br>
La condition n&gt;p permet la d&eacute;termination du vecteur c par une m&eacute;thode
d'ajustement aux moindre carr&eacute;s. Le meilleur ajustement est recherch&eacute;
en minimisant le chi2 par la formule suivante: </p>
  <center> 
  <p>chi2 = (y-X*c)<sup>T</sup>*w*(y-X*c)</p>
  </center>
  
  <p>o&ugrave; w est une matrice n*n dont les &eacute;l&eacute;ments de la 
diagonale sont associ&eacute;s aux variances des mesures des n observations. 
Si l'on ne souhaite pas pond&eacute;rer les diverses mesures du vecteur y,
alors w sera une matrice unitaire. Les valeurs des &eacute;l&eacute;ments 
de la diagonale de la matrice w sont remplies avec les valeurs du vecteur 
W (param&egrave;tre ListVectorW) </p>
  <p>En retour, on a une liste de trois &eacute;l&eacute;ments:</p>
</ul>
  
<ul>
 
  <ul>
1er &eacute;l&eacute;ment : vecteur des solutions c. 
    <p>2&egrave;me &eacute;l&eacute;ment : chi2 de l'ajustement. </p>
    <p>3&egrave;me &eacute;l&eacute;ment : matrice des covariances.</p>
  </ul>
  
  <p><br>
Exemple : On dispose de n mesures d'un signal (x,y), que l'on souhaite ajuster
par une loi parabolique : </p>
  <center> 
  <p>y = c(1) + c(2) * x + c(3) *x*x</p>
  </center>
  
  <p>Le syst&egrave;me comporte donc p=3 inconnues &agrave; d&eacute;terminer: 
c(1), c(2) et c(3). La forme matricielle du syst&egrave;me y=X*c, s'&eacute;crit 
: </p>
  <p><tt>[ y(1) ]&nbsp;&nbsp;&nbsp; [&nbsp; 1&nbsp; x(1)&nbsp; x(1)*x(1) ]</tt> 
  <br>
  <tt>[ y(2) ]&nbsp;&nbsp;&nbsp; [&nbsp; 1&nbsp; x(2)&nbsp; x(2)*x(2) ]</tt> 
  <br>
  <tt>...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
[ c(1) ]</tt> <br>
  <tt>[ y(i) ]&nbsp; = [&nbsp; 1&nbsp; x(i)&nbsp; x(i)*x(i) ] * [ c(2) ]</tt> 
  <br>
  <tt>...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
[ c(3) ]</tt> <br>
  <tt>[ y(n) ]&nbsp;&nbsp;&nbsp; [&nbsp; 1&nbsp; x(n)&nbsp; x(n)*x(n) ]</tt> 
  </p>
  <p>Application num&eacute;rique : </p>
  <p><b><tt># - definition des mesures</tt></b> <br>
  <b><tt>set x {0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 
3&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp; }</tt></b> 
  <br>
  <b><tt>set y {0.12 0.95 3.78 9.21 15.43 25.83 }</tt></b> <br>
  <b><tt>set w {1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 
1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp; }</tt></b> 
  <br>
  <b><tt># - calcul de la matrice X</tt></b> <br>
  <b><tt>set n [llength $x]</tt></b> <br>
  <b><tt>set X ""</tt></b> <br>
  <b><tt>for {set i 0} {$i&lt;$n} {incr i} {</tt></b> <br>
  <b><tt>&nbsp;&nbsp; set xi [lindex $x $i]</tt></b> <br>
  <b><tt>&nbsp;&nbsp; set&nbsp;&nbsp;&nbsp;&nbsp; ligne_i 1</tt></b> <br>
  <b><tt>&nbsp;&nbsp; lappend ligne_i $xi</tt></b> <br>
  <b><tt>&nbsp;&nbsp; lappend ligne_i [expr $xi*$xi]</tt></b> <br>
  <b><tt>&nbsp;&nbsp; lappend X $ligne_i</tt></b> <br>
  <b><tt>}</tt></b> <br>
  <b><tt># - calcul de l'ajustement</tt></b> <br>
  <b><tt>set result [gsl_mfitmultilin $y $X $w]</tt></b> <br>
  <b><tt># - extrait le resultat</tt></b> <br>
  <b><tt>set c&nbsp;&nbsp;&nbsp;&nbsp; [lindex $result 0]</tt></b> <br>
  <b><tt>set chi2&nbsp; [lindex $result 1]</tt></b> <br>
  <b><tt>set covar [lindex $result 2]</tt></b> </p>
  <p>La variable result vaut : <br>
{0.202500 -0.413893 1.096607} 0.674041 {{0.821429 -0.589286 0.089286} {-0.589286
0.726786 -0.133929} {0.089286 -0.133929 0.026786}} </p>
  <p>L'interpr&eacute;tation du r&eacute;sultat est que le meilleur ajustement 
est obtenu par la fonction&nbsp; : y = 0.202500 - 0.413893*x + 1.096607*x*x</p>
</ul>
  
<h2> 2.4. Transform&eacute;es de Fourier</h2>
  
<h3> <a name="gsl_fft"></a>gsl_fft ListVector ?ListVectorTime?</h3>
  
<blockquote>Effectue la transform&eacute;e de Fourier du vecteur ListVector. 
En retour, on a une liste de deux &eacute;l&eacute;ments:</blockquote>
  
<ul>
 
  <ul>
1er &eacute;l&eacute;ment : vecteur des amplitudes r&eacute;elles 
    <p>2&egrave;me &eacute;l&eacute;ment : vecteur des amplitudes imaginaires</p>
  </ul>
 Si l'on a effectu&eacute; le calcul avec le vecteur ListVectorTime correspondant 
aux instants de mesure chaque point de ListVector, alors un troisi&egrave;me 
&eacute;l&eacute;ment est retourn&eacute; par la fonction gsl_fft. C'est le
vecteur de la valeur des fr&eacute;quences associ&eacute;es &agrave; chaque
point de la TF. 
  <p>Exemple: Nous allons g&eacute;n&eacute;rer un vecteur c(k)=sin(k) dont 
les valeurs varient sinuso&iuml;dalement pour 0&lt;=k&lt;100, puis nous allons
visualiser le module de sa transform&eacute;e de Fourier: </p>
  <p><b><tt>set n 100</tt></b> <br>
  <b><tt>set c ""</tt></b> <br>
  <b><tt>set t ""</tt></b> <br>
  <b><tt>for {set k 0} {$k&lt;$n} {incr k} {</tt></b> <br>
  <b><tt>&nbsp;&nbsp; set value [expr sin($k)]</tt></b> <br>
  <b><tt>&nbsp;&nbsp; lappend c $value</tt></b> <br>
  <b><tt>&nbsp;&nbsp; lappend t $k</tt></b> <br>
  <b><tt>}</tt></b> <br>
  <b><tt>set fft [gsl_fft $c $t]</tt></b> <br>
  <b><tt>set fftr [lindex $fft 0]</tt></b> <br>
  <b><tt>set ffti [lindex $fft 1]</tt></b> <br>
  <b><tt>set freq [lindex $fft 2]</tt></b> <br>
  <b><tt>set module ""</tt></b> <br>
  <b><tt>for {set k 0} {$k&lt;$n} {incr k} {</tt></b> <br>
  <b><tt>&nbsp;&nbsp; set x [lindex $fftr $k]</tt></b> <br>
  <b><tt>&nbsp;&nbsp; set y [lindex $ffti $k]</tt></b> <br>
  <b><tt>&nbsp;&nbsp; set value [expr sqrt($x*$x+$y*$y)]</tt></b> <br>
  <b><tt>&nbsp;&nbsp; lappend module $value</tt></b> <br>
  <b><tt>}</tt></b> <br>
  <b><tt>::plotxy::figure 1</tt></b> <br>
  <b><tt>::plotxy::plot $freq $module</tt></b> <br>
  <b><tt>::plotxy::xlabel "frequency (Hz)"</tt></b> <br>
  <b><tt>::plotxy::ylabel "module intensity"</tt></b> <br>
  <b><tt>::plotxy::title "FFT of a sinus function"</tt></b> </p>
  <p>Cet exemple affiche le r&eacute;sultat sous la forme d'un graphe gr&acirc;ce 
aux fonctions du <a href="audplotxy.htm">namespace ::plotxy</a> disponible 
dans Aud'ACE. Sur le graphe, on remarquera que la fr&eacute;quence de Nyquist 
est 0.5Hz (= inverse de deux fois la dur&eacute;e totale du signal temporel). 
Au del&agrave; de 0.5Hz, on assiste &agrave; un ph&eacute;nom&egrave;ne d'aliasing.</p>
</ul>
  
<h3> <a name="gsl_ifft"></a>gsl_ifft ListVectorReal ListVectorImag ?ListVectorFreq?</h3>
  
<blockquote>Effectue la transform&eacute;e de Fourier inverse des vecteurs 
ListVectorReal (vecteur des amplitudes r&eacute;elles) et ListVectorImag (vecteur
des amplitudes imaginaires) et retourne un vecteur. Si l'on a effectu&eacute;
le calcul avec le vecteur ListVectorFreq correspondant aux fr&eacute;quences
de mesure de chaque point, alors un second &eacute;l&eacute;ment est retourn&eacute;
par la fonction gsl_fft. C'est le vecteur de la valeur des instants associ&eacute;es
&agrave; chaque point de la TF inverse.<br>
</blockquote>
<h2>2.5. Fonctions sp&eacute;ciales</h2>
<h3> <a name="gsl_sphharm"></a>gsl_sphharm double l m</h3>
<blockquote>  Retourne le polynomne de Legendre associ&eacute; P_l^m(double)
pour m&gt;=0, l&gt;=m et |double|&lt;=1<br>
Fonction inclue dans libgsltcl par Harald Rischbieter ( har.risch@gmx.de
).<br>
&nbsp; <br>
</blockquote>
 <!-- #BeginLibraryItem "/11/Library/MAJ%20AK.lbi" --><i><font size="2">Cette
page est tenue &agrave; jour par Alain Klotz.</font></i><!-- #EndLibraryItem --><br>
 <i><font size="-1">Derni&egrave;re mise &agrave; jour le : </font></i>07/09/2003
 <br>
 <!-- #BeginLibraryItem "/11/Library/barre%20de%20nav%20du%20bas.lbi" --> 
<div align="center">   
<table width="60%" border="0" cellspacing="0" cellpadding="0">
     <tbody>
    <tr>
        <td> 
      <p align="center"><font
 face="Verdana, Arial, Helvetica, sans-serif" size="2"><a
 href="index.htm">Accueil</a>            | <a href="copi.htm">Copies d'&eacute;crans</a>
| <a href="telecha.htm">T&eacute;l&eacute;charger</a>            | <a
 href="plan.php">Plan du site</a> | <a href="interfa.htm">Interface     
      standard</a> | <a href="theme.htm">Observations &agrave; th&egrave;mes</a>
           | <a href="script.htm">Scripts</a> | <a href="extensio.htm">Extensions</a>
           | <a href="faq.htm">FAQ</a> | <a href="quiveu.htm">Qui veut aider
           ?</a> | <a href="liens.htm">Liens</a> | <a href="bug.php">Suivi
           des bugs</a> | <a href="followup.php">Suivi des scripts</a></font></p>
         
      <p align="center">&nbsp;</p>
       </td>
     </tr>
   
  </tbody>
</table>
    </div>
 <!-- #EndLibraryItem --><br>
</body>
</html>
